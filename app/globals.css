@import "tailwindcss";

@theme {
  --font-sans: "Inter", "Inter Fallback", system-ui, sans-serif;
  --font-serif: "Lora", "Lora Fallback", Georgia, serif;
  --font-mono:
    "JetBrains Mono", "JetBrains Mono Fallback", ui-monospace, monospace;

  --breakpoint-xs: 32rem;

  --text-2xs: 0.625rem;
  --text-2xs--line-height: calc(0.75 / 0.625);

  /* Blue-based color system */
  --color-background: hsl(0 0% 99%);
  --color-foreground: hsl(210 25% 23%);
  --color-muted-foreground: hsl(210 15% 60%);
  --color-primary: hsl(210 88% 53%);
  --color-border: hsl(201 30% 88%);
  --color-card: hsl(180 6% 97%);
  --color-muted: hsl(240 8% 92%);

  /* Keep neutral scale for code blocks etc */
  --color-neutral-50: #faf9f5;
  --color-neutral-100: #f5f2ec;
  --color-neutral-200: #e8e6dc;
  --color-neutral-300: #d4d2c9;
  --color-neutral-400: #adaba2;
  --color-neutral-500: #87867f;
  --color-neutral-600: #73726d;
  --color-neutral-700: #5e5d59;
  --color-neutral-800: #3e3d3b;
  --color-neutral-900: #1f1e1d;
  --color-neutral-950: #0f0f0e;

  --color-blue-50: #f5f7fa;
  --color-blue-100: #ebf1f7;
  --color-blue-200: #d6e4f5;
  --color-blue-300: #b3cff0;
  --color-blue-400: #44a6e4;
  --color-blue-500: #5e7edf;
  --color-blue-600: #4b65b3;
  --color-blue-700: #3b4f8c;
  --color-blue-800: #2f3f70;
  --color-blue-900: #263359;
  --color-blue-950: #192038;
}

@layer base {
  body {
    background-color: var(--color-background);
    color: var(--color-foreground);
    letter-spacing: -0.011em;
  }

  *::selection {
    background-color: color-mix(
      in srgb,
      var(--color-primary) 15%,
      transparent
    );
    color: var(--color-foreground);
  }

  em,
  q,
  i {
    @apply font-serif text-base leading-none italic;
  }

  strong,
  b {
    @apply font-semibold;
  }

  figure[data-rehype-pretty-code-figure] pre {
    scrollbar-width: thin;
    scrollbar-color: var(--color-neutral-200) var(--color-neutral-100);
    @apply overflow-x-auto border border-neutral-200 bg-neutral-100 py-2;
  }

  figure[data-rehype-pretty-code-figure] pre::-webkit-scrollbar {
    @apply h-1 bg-neutral-100;
  }

  figure[data-rehype-pretty-code-figure] pre::-webkit-scrollbar-track {
    @apply bg-neutral-100;
  }

  figure[data-rehype-pretty-code-figure] pre::-webkit-scrollbar-thumb {
    @apply rounded-none bg-neutral-200;
  }

  figure[data-rehype-pretty-code-figure] pre > code {
    counter-reset: line;
  }

  figure[data-rehype-pretty-code-figure] code[data-line-numbers] {
    counter-reset: line;
  }

  figure[data-rehype-pretty-code-figure]
    code[data-line-numbers]
    > [data-line]::before {
    counter-increment: line;
    content: counter(line);
    @apply mr-4 inline-block w-4 text-right;
    color: var(--color-muted-foreground);
  }

  figure[data-rehype-pretty-code-figure]
    code[data-line-numbers-max-digits="3"]
    > [data-line]::before {
    @apply w-5;
  }

  figure[data-rehype-pretty-code-figure]
    code[data-line-numbers-max-digits="4"]
    > [data-line]::before {
    @apply w-7;
  }

  figure[data-rehype-pretty-code-figure] [data-line] {
    @apply border-l border-transparent pl-2;
  }

  figure[data-rehype-pretty-code-figure] [data-highlighted-line] {
    @apply border-l border-blue-400 bg-blue-500/10;
  }

  figure[data-rehype-pretty-code-figure]
    code[data-line-numbers]
    > [data-highlighted-line]::before {
    color: var(--color-foreground);
  }

  figure[data-rehype-pretty-code-figure] [data-highlighted-chars] {
    @apply rounded bg-blue-500/10;
    box-shadow: 0 0 0 2px rgb(21 93 252 / 0.1);
  }

  [data-rehype-pretty-code-title] {
    @apply border-x border-t border-neutral-200 p-2 font-medium;
  }

  [data-rehype-pretty-code-caption] {
    @apply mt-2;
    color: var(--color-muted-foreground);
  }

  [data-rmiz-content="found"] img,
  [data-rmiz-content="found"] svg,
  [data-rmiz-content="found"] [role="img"],
  [data-rmiz-content="found"] [data-zoom] {
    @apply !cursor-pointer;
  }

  .katex-display {
    scrollbar-width: thin;
    scrollbar-color: var(--color-neutral-200) var(--color-background);
    @apply overflow-x-auto overflow-y-hidden;
  }

  .katex-display::-webkit-scrollbar {
    @apply h-1 bg-neutral-100;
  }

  .katex-display::-webkit-scrollbar-track {
    @apply bg-neutral-100;
  }

  .katex-display::-webkit-scrollbar-thumb {
    @apply rounded-none bg-neutral-200;
  }
}

@layer components {
  .btn {
    @apply cursor-pointer rounded px-2 py-1 text-xs transition-colors;
    border: 1px solid var(--color-border);
    color: var(--color-muted-foreground);
  }
  .btn:hover {
    border-color: var(--color-foreground);
    color: var(--color-foreground);
  }

  /* Link with expanding underline hover */
  .link {
    @apply relative inline w-fit rounded py-0.5 transition-colors;
    color: var(--color-muted-foreground);
  }
  .link::after {
    content: "";
    @apply absolute inset-x-0 -z-10 w-full rounded transition-all;
    bottom: 10%;
    height: 1px;
    background-color: var(--color-border);
  }
  .link:hover::after {
    height: 80%;
    background-color: var(--color-muted);
  }

  /* Post list item hover */
  .post-link {
    color: var(--color-muted-foreground);
    transition: color 0.15s;
  }
  .post-link:hover {
    color: var(--color-foreground);
  }
  .post-link:hover .post-link-line {
    border-color: var(--color-foreground);
  }
  .post-link:hover .post-link-date {
    color: var(--color-foreground);
  }
}

@layer utilities {
  hr {
    @apply my-8;
    border-color: var(--color-border);
  }
}

@supports (view-transition-name: none) {
  @media not (prefers-reduced-motion: reduce) {
    ::view-transition-group(crossfade),
    ::view-transition-group(root) {
      animation-duration: 0s;
    }

    ::view-transition-old(root),
    ::view-transition-new(root) {
      animation: none;
      mix-blend-mode: normal;
    }

    ::view-transition-old(crossfade) {
      animation: hide 0.4s cubic-bezier(0.6, 0, 0.8, 1) forwards;
    }

    ::view-transition-new(crossfade) {
      opacity: 0;
      animation: appear 0.6s ease 0.2s forwards;
    }
  }
}

@keyframes hide {
  0% {
    opacity: 1;
    transform: translateY(0);
  }
  100% {
    opacity: 0;
    transform: translateY(-8px);
  }
}

@keyframes appear {
  0% {
    opacity: 0;
    transform: translateY(8px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}
